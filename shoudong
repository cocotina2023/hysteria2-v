#一键安装Hysteria2
bash <(curl -fsSL https://get.hy2.sh/)

#生成自签证书
openssl req -x509 -nodes -newkey ec:<(openssl ecparam -name prime256v1) -keyout /etc/hysteria/server.key -out /etc/hysteria/server.crt -subj "/CN=bing.com" -days 36500 && sudo chown hysteria /etc/hysteria/server.key && sudo chown hysteria /etc/hysteria/server.crt

#启动Hysteria2
systemctl start hysteria-server.service
#重启Hysteria2
systemctl restart hysteria-server.service
#查看Hysteria2状态
systemctl status hysteria-server.service
#停止Hysteria2
systemctl stop hysteria-server.service
#设置开机自启
systemctl enable hysteria-server.service
#查看日志
journalctl -u hysteria-server.service

#################
cat << EOF > /etc/hysteria/config.yaml
listen: :443 #监听端口

#使用CA证书
#acme:
#  domains:
#    - a.com #你的域名，需要先解析到服务器ip
#  email: test@sharklasers.com

#使用自签证书
#tls:
#  cert: /etc/hysteria/server.crt
#  key: /etc/hysteria/server.key

auth:
  type: password
  password: 123456 #设置认证密码
  
masquerade:
  type: proxy
  proxy:
    url: https://bing.com #伪装网址
    rewriteHost: true
EOF






##########3
#########
##########
###########
这条命令的作用是生成 EC（椭圆曲线）自签名证书 并设置文件权限，适用于 Hysteria 服务。我们逐项拆解：

openssl req -x509 \
  -nodes \                                # 不给私钥加密
  -newkey ec:<(openssl ecparam -name prime256v1) \  # 生成一个新的 EC 密钥，使用 prime256v1 曲线
  -keyout /etc/hysteria/server.key \      # 输出私钥到 /etc/hysteria/server.key
  -out /etc/hysteria/server.crt \         # 输出自签名证书到 /etc/hysteria/server.crt
  -subj "/CN=bing.com" \                  # 设置证书主题 (CN = bing.com)
  -days 36500                              # 证书有效期：36500 天 (~100 年)
&& sudo chown hysteria /etc/hysteria/server.key \   # 将私钥所有权改为 hysteria 用户
&& sudo chown hysteria /etc/hysteria/server.crt    # 将证书所有权改为 hysteria 用户

生成结果：

/etc/hysteria/server.key → EC 私钥

/etc/hysteria/server.crt → 自签名证书

关键点：

使用 椭圆曲线（EC） 密钥比 RSA 更轻量且安全。这里用的是 prime256v1 曲线。

-nodes 表示私钥不加密，Hysteria 服务可以直接读取。

-days 36500 有效期极长（100 年），通常只是为了测试或长期使用，不建议在生产环境中这么久。

sudo chown hysteria ... 确保 Hysteria 服务用户可以访问私钥和证书。

如果你需要，我可以帮你改写成 支持 SAN 的现代自签名证书命令，这样浏览器或客户端不会报 CN 过时的警告。
